{"version":3,"file":"client.js","sourceRoot":"","sources":["../client.ts"],"names":[],"mappings":"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","sourcesContent":["// Sol√∏ API client\n\nexport interface Task {\n\tuserID?:   string;\n\tname?:     string;\n\tcomplete?: boolean;\n\tafter?:    string;\n}\n\nexport interface Token {\n\tuserID?: string;\n\ttoken?:  string;\n}\n\nexport interface User {\n\tname?:         string;\n\temail?:        string;\n\tpassword?:     string;\n\tserviceAdmin?: boolean;\n}\n\nexport interface Metadata {\n\tid:           string;\n\tetag:         string;\n\tgeneration:   number;\n}\n\nexport interface GetOpts<T> {\n\tprev?: T & Metadata;\n}\n\nexport interface ListOpts<T> {\n\tstream?:  string;\n\tlimit?:   number;\n\toffset?:  number;\n\tafter?:   string;\n\tsorts?:   string[];\n\tfilters?: Filter[];\n\tprev?:    (T & Metadata)[];\n}\n\nexport interface Filter {\n\tpath:   string;\n\top:     string;\n\tvalue:  string;\n}\n\nexport interface UpdateOpts<T> {\n\tprev?: T & Metadata;\n}\n\nexport interface JSONError {\n\tmessages:  string[];\n}\n\nconst ETagKey = Symbol('etag');\n\nexport class Client {\n\tprivate baseURL: URL;\n\tprivate headers: Headers = new Headers();\n\n\tconstructor(baseURL: string) {\n\t\tthis.baseURL = new URL(baseURL, globalThis?.location?.href);\n\t}\n\n\t// Skipped: setDebug()\n\n\tsetHeader(name: string, value: string) {\n\t\tthis.headers.set(name, value)\n\t}\n\n\tresetAuth() {\n\t\tthis.headers.delete('Authorization');\n\t}\n\n\tsetBasicAuth(user: string, pass: string) {\n\t\tconst enc = btoa(`${user}:${pass}`);\n\t\tthis.headers.set('Authorization', `Basic ${enc}`);\n\t}\n\n\tsetAuthToken(token: string) {\n\t\tthis.headers.set('Authorization', `Bearer ${token}`);\n\t}\n\n\tasync debugInfo(): Promise<Object> {\n\t\tconst req = this.newReq('GET', '_debug');\n\t\treturn req.fetchJSON();\n\t}\n\n\tasync openAPI(): Promise<Object> {\n\t\tconst req = this.newReq('GET', '_openapi');\n\t\treturn req.fetchJSON();\n\t}\n\n\tasync goClient(): Promise<string> {\n\t\tconst req = this.newReq('GET', '_client.go');\n\t\treturn req.fetchText();\n\t}\n\n\tasync tsClient(): Promise<string> {\n\t\tconst req = this.newReq('GET', '_client.ts');\n\t\treturn req.fetchText();\n\t}\n\n\t//// Task\n\n\tasync createTask(obj: Task): Promise<Task & Metadata> {\n\t\treturn this.createName<Task>('task', obj);\n\t}\n\n\tasync deleteTask(id: string, opts?: UpdateOpts<Task> | null): Promise<void> {\n\t\treturn this.deleteName('task', id, opts);\n\t}\n\n\tasync findTask(shortID: string): Promise<Task & Metadata> {\n\t\treturn this.findName<Task>('task', shortID);\n\t}\n\n\tasync getTask(id: string, opts?: GetOpts<Task> | null): Promise<Task & Metadata> {\n\t\treturn this.getName<Task>('task', id, opts);\n\t}\n\n\tasync listTask(opts?: ListOpts<Task> | null): Promise<(Task & Metadata)[]> {\n\t\treturn this.listName<Task>('task', opts);\n\t}\n\n\tasync replaceTask(id: string, obj: Task, opts?: UpdateOpts<Task> | null): Promise<Task & Metadata> {\n\t\treturn this.replaceName<Task>('task', id, obj, opts);\n\t}\n\n\tasync updateTask(id: string, obj: Task, opts?: UpdateOpts<Task> | null): Promise<Task & Metadata> {\n\t\treturn this.updateName<Task>('task', id, obj, opts);\n\t}\n\n\tasync streamGetTask(id: string, opts?: GetOpts<Task> | null): Promise<GetStream<Task>> {\n\t\treturn this.streamGetName<Task>('task', id, opts);\n\t}\n\n\tasync streamListTask(opts?: ListOpts<Task> | null): Promise<ListStream<Task>> {\n\t\treturn this.streamListName<Task>('task', opts);\n\t}\n\n\t//// Token\n\n\tasync createToken(obj: Token): Promise<Token & Metadata> {\n\t\treturn this.createName<Token>('token', obj);\n\t}\n\n\tasync deleteToken(id: string, opts?: UpdateOpts<Token> | null): Promise<void> {\n\t\treturn this.deleteName('token', id, opts);\n\t}\n\n\tasync findToken(shortID: string): Promise<Token & Metadata> {\n\t\treturn this.findName<Token>('token', shortID);\n\t}\n\n\tasync getToken(id: string, opts?: GetOpts<Token> | null): Promise<Token & Metadata> {\n\t\treturn this.getName<Token>('token', id, opts);\n\t}\n\n\tasync listToken(opts?: ListOpts<Token> | null): Promise<(Token & Metadata)[]> {\n\t\treturn this.listName<Token>('token', opts);\n\t}\n\n\tasync replaceToken(id: string, obj: Token, opts?: UpdateOpts<Token> | null): Promise<Token & Metadata> {\n\t\treturn this.replaceName<Token>('token', id, obj, opts);\n\t}\n\n\tasync updateToken(id: string, obj: Token, opts?: UpdateOpts<Token> | null): Promise<Token & Metadata> {\n\t\treturn this.updateName<Token>('token', id, obj, opts);\n\t}\n\n\tasync streamGetToken(id: string, opts?: GetOpts<Token> | null): Promise<GetStream<Token>> {\n\t\treturn this.streamGetName<Token>('token', id, opts);\n\t}\n\n\tasync streamListToken(opts?: ListOpts<Token> | null): Promise<ListStream<Token>> {\n\t\treturn this.streamListName<Token>('token', opts);\n\t}\n\n\t//// User\n\n\tasync createUser(obj: User): Promise<User & Metadata> {\n\t\treturn this.createName<User>('user', obj);\n\t}\n\n\tasync deleteUser(id: string, opts?: UpdateOpts<User> | null): Promise<void> {\n\t\treturn this.deleteName('user', id, opts);\n\t}\n\n\tasync findUser(shortID: string): Promise<User & Metadata> {\n\t\treturn this.findName<User>('user', shortID);\n\t}\n\n\tasync getUser(id: string, opts?: GetOpts<User> | null): Promise<User & Metadata> {\n\t\treturn this.getName<User>('user', id, opts);\n\t}\n\n\tasync listUser(opts?: ListOpts<User> | null): Promise<(User & Metadata)[]> {\n\t\treturn this.listName<User>('user', opts);\n\t}\n\n\tasync replaceUser(id: string, obj: User, opts?: UpdateOpts<User> | null): Promise<User & Metadata> {\n\t\treturn this.replaceName<User>('user', id, obj, opts);\n\t}\n\n\tasync updateUser(id: string, obj: User, opts?: UpdateOpts<User> | null): Promise<User & Metadata> {\n\t\treturn this.updateName<User>('user', id, obj, opts);\n\t}\n\n\tasync streamGetUser(id: string, opts?: GetOpts<User> | null): Promise<GetStream<User>> {\n\t\treturn this.streamGetName<User>('user', id, opts);\n\t}\n\n\tasync streamListUser(opts?: ListOpts<User> | null): Promise<ListStream<User>> {\n\t\treturn this.streamListName<User>('user', opts);\n\t}\n\n\t//// Generic\n\n\tasync createName<T>(name: string, obj: T): Promise<T & Metadata> {\n\t\tconst req = this.newReq<T>('POST', encodeURIComponent(name));\n\t\treq.setBody(obj);\n\t\treturn req.fetchObj();\n\t}\n\n\tasync deleteName<T>(name: string, id: string, opts?: UpdateOpts<T> | null): Promise<void> {\n\t\tconst req = this.newReq<T>('DELETE', `${encodeURIComponent(name)}/${encodeURIComponent(id)}`);\n\t\treq.applyUpdateOpts(opts);\n\t\treturn req.fetchVoid();\n\t}\n\n\tasync findName<T>(name: string, shortID: string): Promise<T & Metadata> {\n\t\tconst opts: ListOpts<T> = {\n\t\t\tfilters: [\n\t\t\t\t{\n\t\t\t\t\tpath: 'id',\n\t\t\t\t\top: 'hp',\n\t\t\t\t\tvalue: shortID,\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\n\t\tconst list = await this.listName<T>(name, opts);\n\n\t\tif (list.length != 1) {\n\t\t\tthrow new Error({\n\t\t\t\tmessages: [\n\t\t\t\t\t'not found',\n\t\t\t\t],\n\t\t\t});\n\t\t}\n\n\t\treturn list[0]!;\n\t}\n\n\tasync getName<T>(name: string, id: string, opts?: GetOpts<T> | null): Promise<T & Metadata> {\n\t\tconst req = this.newReq<T>('GET', `${encodeURIComponent(name)}/${encodeURIComponent(id)}`);\n\t\treq.applyGetOpts(opts);\n\t\treturn req.fetchObj();\n\t}\n\n\tasync listName<T>(name: string, opts?: ListOpts<T> | null): Promise<(T & Metadata)[]> {\n\t\tconst req = this.newReq<T>('GET', `${encodeURIComponent(name)}`);\n\t\treq.applyListOpts(opts);\n\t\treturn req.fetchList();\n\t}\n\n\tasync replaceName<T>(name: string, id: string, obj: T, opts?: UpdateOpts<T> | null): Promise<T & Metadata> {\n\t\tconst req = this.newReq<T>('PUT', `${encodeURIComponent(name)}/${encodeURIComponent(id)}`);\n\t\treq.applyUpdateOpts(opts);\n\t\treq.setBody(obj);\n\t\treturn req.fetchObj();\n\t}\n\n\tasync updateName<T>(name: string, id: string, obj: T, opts?: UpdateOpts<T> | null): Promise<T & Metadata> {\n\t\tconst req = this.newReq<T>('PATCH', `${encodeURIComponent(name)}/${encodeURIComponent(id)}`);\n\t\treq.applyUpdateOpts(opts);\n\t\treq.setBody(obj);\n\t\treturn req.fetchObj();\n\t}\n\n\tasync streamGetName<T>(name: string, id: string, opts?: GetOpts<T> | null): Promise<GetStream<T>> {\n\t\tconst req = this.newReq<T>('GET', `${encodeURIComponent(name)}/${encodeURIComponent(id)}`);\n\t\treq.applyGetOpts(opts);\n\n\t\tconst controller = new AbortController();\n\t\treq.setSignal(controller.signal);\n\n\t\tconst resp = await req.fetchStream();\n\n\t\treturn new GetStream<T>(resp, controller, opts?.prev);\n\t}\n\n\tasync streamListName<T>(name: string, opts?: ListOpts<T> | null): Promise<ListStream<T>> {\n\t\tconst req = this.newReq<T>('GET', `${encodeURIComponent(name)}`);\n\t\treq.applyListOpts(opts);\n\n\t\tconst controller = new AbortController();\n\t\treq.setSignal(controller.signal);\n\n\t\tconst resp = await req.fetchStream();\n\n\t\ttry {\n\t\t\tswitch (resp.headers.get('Stream-Format')) {\n\t\t\tcase 'full':\n\t\t\t\treturn new ListStreamFull<T>(resp, controller, opts?.prev);\n\n\t\t\tcase 'diff':\n\t\t\t\treturn new ListStreamDiff<T>(resp, controller, opts?.prev);\n\n\t\t\tdefault:\n\t\t\t\tthrow new Error({\n\t\t\t\t\tmessages: [\n\t\t\t\t\t\t`invalid Stream-Format: ${resp.headers.get('Stream-Format')}`,\n\t\t\t\t\t],\n\t\t\t\t});\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tcontroller.abort();\n\t\t\tthrow e;\n\t\t}\n\t}\n\n\tprivate newReq<T = void>(method: string, path: string): Req<T> {\n\t\tconst url = new URL(path, this.baseURL);\n\t\treturn new Req<T>(method, url, this.headers);\n\t}\n}\n\nclass Scanner {\n\tprivate reader: ReadableStreamDefaultReader;\n\tprivate buf: string = '';\n\n\tconstructor(stream: ReadableStream) {\n\t\tthis.reader = stream.pipeThrough(new TextDecoderStream()).getReader();\n\t}\n\n\tasync readLine(): Promise<string | null> {\n\t\twhile (!this.buf.includes('\\n')) {\n\t\t\tlet chunk: ReadableStreamReadResult<any>;\n\n\t\t\ttry {\n\t\t\t\tchunk = await this.reader.read();\n\t\t\t} catch {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tif (chunk.done) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tthis.buf += chunk.value;\n\t\t}\n\n\t\tconst lineEnd = this.buf.indexOf('\\n');\n\t\tconst line = this.buf.substring(0, lineEnd);\n\t\tthis.buf = this.buf.substring(lineEnd + 1);\n\t\treturn line;\n\t}\n}\n\nclass StreamEvent<T> {\n\teventType: string = '';\n\tparams:    Map<string, string> = new Map();\n\tdata:      string = '';\n\n\tdecodeObj(): T & Metadata {\n\t\treturn JSON.parse(this.data);\n\t}\n\n\tdecodeList(): (T & Metadata)[] {\n\t\treturn JSON.parse(this.data);\n\t}\n}\n\nclass EventStream<T> {\n\tprivate scan: Scanner;\n\n\tconstructor(stream: ReadableStream) {\n\t\tthis.scan = new Scanner(stream);\n\t}\n\n\tasync readEvent(): Promise<StreamEvent<T> | null> {\n\t\tconst data: string[] = [];\n\t\tconst ev = new StreamEvent<T>();\n\n\t\twhile (true) {\n\t\t\tconst line = await this.scan.readLine();\n\n\t\t\tif (line == null) {\n\t\t\t\treturn null;\n\n\t\t\t} else if (line.startsWith(':')) {\n\t\t\t\tcontinue;\n\n\t\t\t} else if (line.startsWith('event: ')) {\n\t\t\t\tev.eventType = trimPrefix(line, 'event: ');\n\n\t\t\t} else if (line.startsWith('data: ')) {\n\t\t\t\tdata.push(trimPrefix(line, 'data: '));\n\n\t\t\t} else if (line.includes(': ')) {\n\t\t\t\tconst [k, v] = line.split(': ', 2);\n\t\t\t\tev.params.set(k!, v!);\n\n\t\t\t} else if (line == '') {\n\t\t\t\tev.data = data.join('\\n');\n\t\t\t\treturn ev;\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport class GetStream<T> {\n\tprivate eventStream: EventStream<T>;\n\tprivate controller: AbortController;\n\tprivate prev: (T & Metadata) | null;\n\tprivate lastEvent: Date = new Date();\n\n\tconstructor(resp: Response, controller: AbortController, prev: (T & Metadata) | null | undefined) {\n\t\tthis.eventStream = new EventStream<T>(resp.body!);\n\t\tthis.controller = controller;\n\t\tthis.prev = prev ?? null;\n\t}\n\n\tlastEventReceived(): Date {\n\t\treturn this.lastEvent;\n\t}\n\n\tasync abort() {\n\t\tthis.controller.abort();\n\t}\n\n\tasync read(): Promise<(T & Metadata) | null> {\n\t\twhile (true) {\n\t\t\tconst ev = await this.eventStream.readEvent();\n\n\t\t\tif (ev == null) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tthis.lastEvent = new Date();\n\n\t\t\tswitch (ev.eventType) {\n\t\t\tcase 'initial':\n\t\t\tcase 'update':\n\t\t\t\treturn ev.decodeObj();\n\n\t\t\tcase 'notModified':\n\t\t\t\treturn this.prev;\n\n\t\t\tcase 'heartbeat':\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t}\n\n\tasync close() {\n\t\tthis.abort();\n\n\t\tfor await (const _ of this) {}\n\t}\n\n\tasync *[Symbol.asyncIterator](): AsyncIterableIterator<T & Metadata> {\n\t\twhile (true) {\n\t\t\tconst obj = await this.read();\n\n\t\t\tif (obj == null) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tyield obj;\n\t\t}\n\t}\n}\n\nexport abstract class ListStream<T> {\n\tprotected eventStream: EventStream<T>;\n\tprivate controller: AbortController;\n\tprotected lastEvent: Date = new Date();\n\n\tconstructor(resp: Response, controller: AbortController) {\n\t\tthis.eventStream = new EventStream<T>(resp.body!);\n\t\tthis.controller = controller;\n\t}\n\n\tlastEventReceived(): Date {\n\t\treturn this.lastEvent;\n\t}\n\n\tasync abort() {\n\t\tthis.controller.abort();\n\t}\n\n\tasync close() {\n\t\tthis.abort();\n\n\t\tfor await (const _ of this) {}\n\t}\n\n\tabstract read(): Promise<(T & Metadata)[] | null>;\n\n\tasync *[Symbol.asyncIterator](): AsyncIterableIterator<(T & Metadata)[]> {\n\t\twhile (true) {\n\t\t\tconst list = await this.read();\n\n\t\t\tif (list == null) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tyield list;\n\t\t}\n\t}\n}\n\nexport class ListStreamFull<T> extends ListStream<T> {\n\tprivate prev: (T & Metadata)[] | null;\n\n\tconstructor(resp: Response, controller: AbortController, prev: (T & Metadata)[] | null | undefined) {\n\t\tsuper(resp, controller);\n\t\tthis.prev = prev ?? null;\n\t}\n\n\tasync read(): Promise<(T & Metadata)[] | null> {\n\t\twhile (true) {\n\t\t\tconst ev = await this.eventStream.readEvent();\n\n\t\t\tif (ev == null) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tthis.lastEvent = new Date();\n\n\t\t\tswitch (ev.eventType) {\n\t\t\tcase 'list':\n\t\t\t\treturn ev.decodeList();\n\n\t\t\tcase 'notModified':\n\t\t\t\treturn this.prev;\n\n\t\t\tcase 'heartbeat':\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport class ListStreamDiff<T> extends ListStream<T> {\n\tprivate prev: (T & Metadata)[] | null;\n\tprivate objs: (T & Metadata)[] = [];\n\n\tconstructor(resp: Response, controller: AbortController, prev: (T & Metadata)[] | null | undefined) {\n\t\tsuper(resp, controller);\n\t\tthis.prev = prev ?? null;\n\t}\n\n\tasync read(): Promise<(T & Metadata)[] | null> {\n\t\twhile (true) {\n\t\t\tconst ev = await this.eventStream.readEvent();\n\n\t\t\tif (ev == null) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tthis.lastEvent = new Date();\n\n\t\t\tswitch (ev.eventType) {\n\t\t\tcase 'add':\n\t\t\t\tthis.objs.splice(parseInt(ev.params.get('new-position')!, 10), 0, ev.decodeObj());\n\t\t\t\tcontinue;\n\n\t\t\tcase 'update':\n\t\t\t\tthis.objs.splice(parseInt(ev.params.get('old-position')!, 10), 1);\n\t\t\t\tthis.objs.splice(parseInt(ev.params.get('new-position')!, 10), 0, ev.decodeObj());\n\t\t\t\tcontinue;\n\n\t\t\tcase 'remove':\n\t\t\t\tthis.objs.splice(parseInt(ev.params.get('old-position')!, 10), 1);\n\t\t\t\tcontinue;\n\n\t\t\tcase 'sync':\n\t\t\t\treturn this.objs;\n\n\t\t\tcase 'notModified':\n\t\t\t\tthis.objs = this.prev!;\n\t\t\t\treturn this.objs;\n\n\t\t\tcase 'heartbeat':\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport class Error {\n\tmessages: string[];\n\n\tconstructor(json: JSONError) {\n\t\tthis.messages = json.messages;\n\t}\n\n\ttoString(): string {\n\t\treturn this.messages[0] ?? 'error';\n\t}\n}\n\nclass Req<T> {\n\tprivate method:    string;\n\tprivate url:       URL;\n\tprivate params:    URLSearchParams;\n\tprivate headers:   Headers;\n\tprivate prevObj?:  (T & Metadata)\n\tprivate prevList?: (T & Metadata)[];\n\tprivate body?:     T;\n\tprivate signal?:   AbortSignal;\n\n\tconstructor(method: string, url: URL, headers: Headers) {\n\t\tthis.method = method;\n\t\tthis.url = url;\n\n\t\tthis.params = new URLSearchParams();\n\t\tthis.headers = new Headers(headers);\n\t}\n\n\tapplyGetOpts(opts: GetOpts<T> | null | undefined) {\n\t\tif (!opts) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setPrevObj('If-None-Match', opts?.prev);\n\t}\n\n\tapplyListOpts(opts: ListOpts<T> | null | undefined) {\n\t\tif (!opts) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setPrevList('If-None-Match', opts?.prev);\n\n\t\tif (opts?.stream) {\n\t\t\tthis.setQueryParam('_stream', opts.stream);\n\t\t}\n\n\t\tif (opts?.limit) {\n\t\t\tthis.setQueryParam('_limit', `${opts.limit}`);\n\t\t}\n\n\t\tif (opts?.offset) {\n\t\t\tthis.setQueryParam('_offset', `${opts.offset}`);\n\t\t}\n\n\t\tif (opts?.after) {\n\t\t\tthis.setQueryParam('_after', `${opts.after}`);\n\t\t}\n\n\t\tfor (const filter of opts?.filters || []) {\n\t\t\tthis.setQueryParam(`${filter.path}[${filter.op}]`, filter.value);\n\t\t}\n\n\t\tfor (const sort of opts?.sorts || []) {\n\t\t\tthis.addQueryParam('_sort', sort);\n\t\t}\n\t}\n\n\tapplyUpdateOpts(opts: UpdateOpts<T> | null | undefined) {\n\t\tif (!opts) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setPrevObj('If-Match', opts?.prev);\n\t}\n\n\tsetPrevObj(headerName: string, obj: (T & Metadata) | null | undefined) {\n\t\tif (!obj) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.headers.set(headerName, this.getETag(obj));\n\t\tthis.prevObj = obj;\n\t}\n\n\tsetPrevList(headerName: string, list: (T & Metadata)[] | null | undefined) {\n\t\tif (!list) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.headers.set(headerName, this.getETag(list));\n\t\tthis.prevList = list;\n\t}\n\n\tsetSignal(signal: AbortSignal) {\n\t\tthis.signal = signal;\n\t}\n\n\tsetBody(obj: T) {\n\t\tthis.body = obj;\n\t\tthis.headers.set('Content-Type', 'application/json');\n\t}\n\n\tsetHeader(name: string, value: string) {\n\t\tthis.headers.set(name, value);\n\t}\n\n\tsetQueryParam(name: string, value: string) {\n\t\tthis.params.set(name, value);\n\t}\n\n\taddQueryParam(name: string, value: string) {\n\t\tthis.params.append(name, value);\n\t}\n\n\tasync fetchObj(): Promise<T & Metadata> {\n\t\tthis.headers.set('Accept', 'application/json');\n\t\tconst resp = await this.fetch();\n\n\t\tif (this?.prevObj && resp.status == 304) {\n\t\t\treturn this.prevObj;\n\t\t}\n\n\t\tawait this.throwOnError(resp);\n\n\t\tconst obj = await resp.json();\n\t\tthis.setETag(obj, resp);\n\t\treturn obj;\n\t}\n\n\tasync fetchList(): Promise<(T & Metadata)[]> {\n\t\tthis.headers.set('Accept', 'application/json');\n\t\tconst resp = await this.fetch();\n\n\t\tif (this?.prevList && resp.status == 304) {\n\t\t\treturn this.prevList;\n\t\t}\n\n\t\tawait this.throwOnError(resp);\n\n\t\tconst list = await resp.json();\n\t\tthis.setETag(list, resp);\n\t\treturn list;\n\t}\n\n\tasync fetchJSON(): Promise<Object> {\n\t\tthis.headers.set('Accept', 'application/json');\n\t\tconst resp = await this.fetch();\n\t\tawait this.throwOnError(resp);\n\t\treturn resp.json();\n\t}\n\n\tasync fetchText(): Promise<string> {\n\t\tthis.headers.set('Accept', 'text/plain');\n\t\tconst resp = await this.fetch();\n\t\tawait this.throwOnError(resp);\n\t\treturn resp.text();\n\t}\n\n\tasync fetchStream(): Promise<Response> {\n\t\tthis.headers.set('Accept', 'text/event-stream');\n\t\tconst resp = await this.fetch();\n\t\tawait this.throwOnError(resp);\n\t\treturn resp;\n\t}\n\n\tasync fetchVoid(): Promise<void> {\n\t\tconst resp = await this.fetch();\n\t\tawait this.throwOnError(resp);\n\t}\n\n\tasync throwOnError(resp: Response) {\n\t\tif (!resp.ok) {\n\t\t\tthrow new Error(await resp.json());\n\t\t}\n\t}\n\n\tasync fetch(): Promise<Response> {\n\t\tthis.url.search = `?${this.params}`;\n\n\t\t// TODO: Add timeout\n\t\t// TODO: Add retry strategy\n\t\t// TODO: Add Idempotency-Key support\n\n\t\tconst reqOpts: RequestInit = {\n\t\t\tmethod: this.method,\n\t\t\theaders: this.headers,\n\t\t\tmode: 'cors',\n\t\t\tcredentials: 'omit',\n\t\t\treferrerPolicy: 'no-referrer',\n\t\t\tkeepalive: true,\n\t\t\tsignal: this?.signal ?? null,\n\t\t\tbody: this?.body ? JSON.stringify(this.body) : null,\n\t\t}\n\n\t\tconst req = new Request(this.url, reqOpts);\n\t\treturn fetch(req);\n\t}\n\n\tprivate getETag(obj: Object): string {\n\t\tconst etag = Object.getOwnPropertyDescriptor(obj, ETagKey)?.value;\n\n\t\tif (!etag) {\n\t\t\tthrow(new Error({\n\t\t\t\tmessages: [\n\t\t\t\t\t`missing ETagKey in ${obj}`,\n\t\t\t\t],\n\t\t\t}));\n\t\t}\n\n\t\treturn etag;\n\t}\n\n\tprivate setETag(obj: Object, resp: Response) {\n\t\tif (resp.headers.has('ETag')) {\n\t\t\tObject.defineProperty(obj, ETagKey, {\n\t\t\t\tvalue: resp.headers.get('ETag'),\n\t\t\t});\n\t\t}\n\t}\n}\n\nfunction trimPrefix(s: string, prefix: string): string {\n\treturn s.substring(prefix.length);\n}\n"]}